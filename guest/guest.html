<!DOCTYPE html>
<html><head></head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style type="text/css">

#status{color:red;}

/* tablet */
@media screen and (max-device-width: 992px){
 *{font-size:24px;}
}

/* phone */
@media screen and (max-device-width: 640px){
 *{font-size:48px;}
}
</style>

<body onload="load()"><div><h2>JHS</h2>
<p>login as guest or as user</p>
<hr/>  
<div id='status'>STATUS</div>
<hr/>
<button type="button" id="guest" onclick="logon()">login as quest</button>
<p>
A guest session runs JHS in your browser as front end to J running as your user task on a linux server.<br/><br/>

This is a good way to learn about J. Run some tutorials and experiment before you take the step of installing on your own machine. With J on your machine you can run the same JHS front end or have a choice of jconsole or Jqt.<br/><br/>

A guest session ends when it:<br/>
&bull;has run for <b>LIMIT</b> minutes<br/>
&bull;is idle for <b>IDLE</b> minutes<br/>
&bull;uses excessive resources (e.g. cpu or disk space)<br/><br/>

Use jijx menu>jbreak to break out of a long running loop.<br/><br/>

The session is maintained over a jijx close (esc+q) or browser close.<br/><br/>

A wait is enforced before starting a new session.<br/><br/>

All files created during the session are deleted when the session ends. Use jijx menu>file>jcopy to move files between the guest machine and your browser machine.
</p>
</div>

<script>
var rq;    
var busy= 0; // prevent new request until previous has completed

function load(){document.title= 'jguest';byid('status').innerHTML= 'login required';}

function ajaxrun(p)
{
 if(1==busy) {return;}
 busy= 1;
 rq= new XMLHttpRequest();
 rq.onreadystatechange= ajax;
 rq.open("POST","", true);
 rq.send(p);
}

function ajax()
{
  if(rq.readyState==4)
  {
    busy= 0;
    var t= rq.responseText;
    if("valid"==t)
     setTimeout(gojijx,1000); // timeout to let server spin up
    else
     byid('status').innerHTML= t;
  }
}

function gojijx(){window.location.href= "jijx";}

function logon(){ajaxrun(encode("jserver-guest?"));}

function byid(id){return document.getElementById(id);}
function encode(d){return(encodeURIComponent(d)).replace("/%20/g","+");}
</script>
</body></html>
