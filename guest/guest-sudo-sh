#!/bin/bash
# $1 is op and $2 is port
# can sudo without password

guestpath="$(dirname "$0")"
homebase=`pwd`

case $1 in
 jhs)

  sudo pkill -U p$2
  sudo rm -r -d -f /home/p$2/*
  # aws server may have quota (man quota) and this could limit users disk usage

  limits="--cpu=30 --nofile=1000 --fsize=1000000000"
  su -l -c "prlimit $limits $homebase/jc $guestpath/guest.ijs $2 &" p$2
  ;;

 break)
  echo $1 > 'opx.txt'
  echo $2 > 'portx.txt'

  su -l -c "$homebase/jc -js break\'node\' exit\'\' " p$2
  ;;

esac
  

